<div class="home-container content">
  <app-sidebar></app-sidebar>
  <div class="main-content">
    
    <form (ngSubmit)="onPostSubmit()" #postForm="ngForm">
      <textarea
        [(ngModel)]="newPostContent"
        name="newPostContent"
        placeholder="Γράψτε κάτι..."
        required
      ></textarea>
      <input type="file" (change)="onFileChange($event)" multiple />
      <button type="submit" class="primary-button" [disabled]="!postForm.valid">
        Δημοσίευση
      </button>
    </form>
    

    <div class="timeline">
      <h2>Χρονολόγιο</h2>
      <div *ngFor="let post of posts" class="post">
        
        <div class="post-header">
          <h3>{{ post.creatorName }}</h3>
          <img *ngIf="getProfilePictureUrlById(post.creatorId)" [src]="getProfilePictureUrlById(post.creatorId)" alt="Profile Picture" class="profile-picture" />          <p class="timestamp">{{ post.createdAt | date: 'short' }}</p>
        </div>

        <p>{{ post.freeTxt }}</p>

        <!-- <div *ngIf="post.mediaUrls.length > 0" class="media-content">
          <div *ngFor="let mediaUrl of post.mediaUrls">
            <img *ngIf="mediaUrl.endsWith('.jpg') || mediaUrl.endsWith('.png')" [src]="mediaUrl" alt="Media" />
            <video *ngIf="mediaUrl.endsWith('.mp4')" [src]="mediaUrl" controls></video>
            <audio *ngIf="mediaUrl.endsWith('.mp3')" [src]="mediaUrl" controls></audio>
          </div>
        </div> -->

        <div class="post-actions">
          <button (click)="onLike(post.id)" class="secondary-button">Σημειώστε το ενδιαφέρον</button>
          
          <form (submit)="onCommentSubmit(post.id)">
            <input [(ngModel)]="newComment" name="newComment" placeholder="Γράψτε ένα σχόλιο..." /> <!-- Added name attribute -->
            <button type="submit" class="secondary-button">Σχόλιο</button>
          </form>
        </div>
        <div class="comments-section">
          <div *ngFor="let comment of post.comments | slice:0:commentsToShow[post.id]">
            <div class="comment">
              <img *ngIf="getProfilePictureUrlById(comment.creatorId)" [src]="getProfilePictureUrlById(comment.creatorId)" alt="Profile Picture" class="profile-picture" />
              <p>{{ comment.freeTxt }}</p>
            </div>
          </div>
          <button *ngIf="commentsToShow[post.id] < post.comments.length" (click)="loadMoreComments(post.id)" class="secondary-button">Load More Comments</button>
        </div>


      </div>
    </div>

  </div>
</div>
